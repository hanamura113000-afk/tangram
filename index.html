<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>タングラムパズル</title>
<link rel="icon" href="data:;base64,iVBORw0KGgo=" />
<style>
  :root{ --bg:#f3f6fb; --panel:#fff; --text:#0f172a; --muted:#64748b; --btn:#2563eb; --bar:#eef2f5; }
  *{ box-sizing:border-box; }
  body{ margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans JP",sans-serif; background:var(--bg); color:var(--text); }
  /* スタートカード */
  .center{ min-height:100vh; display:grid; place-items:center;
    background: radial-gradient(1200px 600px at 50% -200px, #eef3fa 0%, var(--bg) 60%, #e9eef7 100%); }
  .card{ width:min(720px,92vw); background:var(--panel); border-radius:18px; padding:48px 40px;
    box-shadow:0 25px 60px rgba(16,24,40,.08); }
  h1{ margin:0 0 28px; text-align:center; letter-spacing:.04em; font-size: clamp(28px, 4vw, 44px); }
  .row{ display:flex; align-items:center; gap:12px; margin:16px 0; }
  .row label{ width:140px; color:var(--muted); font-weight:600; }
  .row input[type="text"]{ flex:1; padding:10px 12px; border:1px solid #cbd5e1; border-radius:10px; font-size:16px; }
  .modes{ display:flex; gap:20px; flex-wrap:wrap; }
  .btn{ display:block; margin:28px auto 0; padding:12px 22px; border:0; border-radius:12px; background:var(--btn); color:#fff; font-weight:700; font-size:18px; cursor:pointer; }

  /* ゲームUI */
  header{ position:sticky; top:0; z-index:10; display:flex; flex-wrap:wrap; gap:12px; align-items:center;
    padding:10px 12px; background:var(--bar); border-bottom:1px solid #e5e7eb; }
  header input[type="text"]{ padding:6px 8px; border:1px solid #cbd5e1; border-radius:6px; width:160px; background:#fff; }
  header button{ padding:8px 12px; border:0; border-radius:8px; cursor:pointer; font-weight:600; }
  .btn-main{ background:var(--btn); color:#fff; }
  .btn-plain{ background:#e2e8f0; color:#0f172a; }
  .grow{ flex:1 1 auto; }
  .wrap{ padding:12px; }
  #stage{ width:100%; height:70vh; background:#fff; border-radius:12px; box-shadow:0 1px 3px rgba(0,0,0,.06); display:block; }
  #footerBar{ position:sticky; bottom:0; display:flex; gap:8px; align-items:center; padding:8px 12px; background:var(--bar); border-top:1px solid #e5e7eb; }
  .timer{ font-weight:800; letter-spacing:.5px; }
  .hint{ color:var(--muted); font-size:12px; }
  @media (max-width:640px){ #stage{ height:62vh; } }
  /* 切替 */
  #gameUI[hidden], #startCard[hidden]{ display:none !important; }
</style>
</head>
<body>

  <!-- スタート画面 -->
  <main class="center" id="startCard">
    <section class="card">
      <h1>タングラムパズル</h1>
      <div class="row">
        <label>回答者の名前：</label>
        <input id="startName" type="text" placeholder="お名前">
      </div>
      <div class="row">
        <label>モード：</label>
        <div class="modes">
          <label><input type="radio" name="startMode" id="startModeA" checked> A（A通常5 → Bフラッシュ5）</label>
          <label><input type="radio" name="startMode" id="startModeB"> B（B通常5 → Aフラッシュ5）</label>
        </div>
      </div>
      <button class="btn" id="startBtn">開始</button>
    </section>
  </main>

  <!-- ゲーム画面（tangram.js が参照するIDをここに用意） -->
  <section id="gameUI" hidden>
    <header>
      <label>名前：
        <input id="playerName" type="text" />
      </label>
      <label style="margin-left:8px;">パターン：</label>
      <label><input type="radio" name="mode" id="modeA" checked> A（通常5＋フラッシュ5）</label>
      <label><input type="radio" name="mode" id="modeB"> B（通常5＋フラッシュ5）</label>
      <button id="btnStart" class="btn-main">開始</button>
      <button id="btnJudge" class="btn-plain">判定</button>
      <div class="grow"></div>
      <div id="nowLabel">現在：—</div>
      <div id="timer" class="timer" style="margin-left:12px;">00:00</div>
      <div class="hint" style="margin-left:12px;">ショートカット：回転 R / 反転 F</div>
    </header>

    <div class="wrap">
      <canvas id="stage"></canvas>
    </div>

    <div id="footerBar">
      <button id="btnRotate" class="btn-plain">回転</button>
      <button id="btnFlip" class="btn-plain">反転</button>
      <div class="hint">※スマホはボタンでも操作できます</div>
    </div>
  </section>

  <!-- 画面切替用スクリプト：遷移せず同ページで開始 -->
  <script>
    const startBtn   = document.getElementById('startBtn');
    const startName  = document.getElementById('startName');
    const startModeA = document.getElementById('startModeA');
    const startCard  = document.getElementById('startCard');
    const gameUI     = document.getElementById('gameUI');

    // ゲームUI側の要素（tangram.js が使う）を取得
    const playerName = document.getElementById('playerName');
    const modeA      = document.getElementById('modeA');
    const modeB      = document.getElementById('modeB');
    const btnStart   = document.getElementById('btnStart');

    startBtn.addEventListener('click', () => {
      const name = (startName.value||'').trim();
      if (!name){ alert('お名前を入力してください'); return; }
      // 値をゲームUIへコピー
      playerName.value = name;
      modeA.checked = startModeA.checked;
      modeB.checked = !startModeA.checked;
      // 画面切替
      startCard.hidden = true;
      gameUI.hidden = false;
      // tangram.js 側の「開始」ボタンを自動クリック（任意）
      // → スタート画面から即ゲームを始めたい場合のみ
      // btnStart.click();
    });
  </script>

  <!-- ゲーム本体 -->
  <script src="tangram.js"></script>
</body>
</html>
